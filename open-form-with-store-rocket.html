<script>
    // keeps track of changes
    var lastName = "";
    
    // constantly check for store rocket popup
    setInterval(
      ()=>{
        // Gets store rocket popup
        let storeRocketPopupAddress = document.getElementsByClassName("mapboxgl-popup-content");
            let directionLink = document.getElementsByClassName("storerocket-popup-buttons-get-directions");
            var facilityLocationField = document.getElementById("wpforms-1707-field_14");
        
        if( directionLink.length < 1 ) { return; }
        
        // if popup is open do inner loop
        if ( storeRocketPopupAddress.length > 0 ) {
          for( let storeIndex in storeRocketPopupAddress ) {
            let storeElement = storeRocketPopupAddress[storeIndex];
            
            // get collection of children
            if( storeElement && storeElement.children ) {
                let popupChildCollection = storeElement.children;  
              
              // for every child do something
              for( let childIndex in popupChildCollection ) {
                let child = popupChildCollection[childIndex];
                    let childClass = child.className;
                  
                // if child class x then make button for X
                if( childClass == "storerocket-popup-name" ) {
                  let buttonId = child.innerHTML.replace(" - ", "-").replace(/\s+/g, "-");
                  let buttonClassName = "btn-order-from-here";
                  facilityLocationField.disabled = false;
                  facilityLocationField.value = buttonId;
                  facilityLocationField.disabled = true;
                  
                  // if last loop is different popup then do the following
                  if ( lastName != child.innerHTML ) 
                      // for every child do something
                        for( let index in popupChildCollection ) {
                            let childAgain = popupChildCollection[index];
                        
                            // get store rocket button group that shows in popup
                            if ( childAgain.className == "storerocket-popup-buttons" ) {

                                // search for storerocket popup buttons location
                                for ( let grandChildIndex in childAgain.children ) {
                                    let grandChild = childAgain.children[grandChildIndex];

                                    // checks for location button div
                                    if ( grandChild.className == "storerocket-popup-location-buttons" ) {

                                        for ( let greatGrandChildIndex in grandChild.children ) {
                                            let greatGrandChild = grandChild.children[greatGrandChildIndex];
                                            // checks for location button div
                                            if ( greatGrandChild.className == "storerocket-popup-location-button" ) { 
                                                console.log( "greatGrandChild = ", greatGrandChild );

                                                // if button is "Connect With Us"
                                                if ( greatGrandChild.innerHTML == "Connect With Us" ) {
                                                    greatGrandChild.classList.add( "trigger-connect" );
                                                }


                                                // if button is "Apply Today"
                                                if ( greatGrandChild.innerHTML == "Apply Today" ) {
                                                    greatGrandChild.classList.add( "trigger-apply" );
                                                }

                                             }
                                        }
                                    }
                                }


                                // div. storerocket-popup-location-buttons
                                // a. storerocket-popup-location-button


                                
                                // check inner html
                                // if innerHTML == Connect With Us -> open up modal-connect
                                
                                // else innerHTML == Apply Today -> open up modal-apply
                            }

                        // change address to order here
                        /*
                        if( childAgain.className == "storerocket-popup-address" ) {
                              childAgain.innerHTML = "<a id=\"" + buttonId + "\" class=\"" + buttonClassName + "\" style=\"font-size: 24px; font-weight: 700;\" href=\"#\" onclick=\"openModal\" >Connect Here</a>";
                        
                        }
                        */
                        
                        // remove directions
                        /*
                        if( childAgain.className == "storerocket-popup-buttons-get-directions" ) {
                              childAgain.remove();
                        }
                        */
                    }
                  
                    // update last modified popup indicator
                    lastName = child.innerHTML;
                    }
                  }
                }
          }
        }
      },
      100   
    ); 
      
    // click modal
    function openModalConnect() {
      let applyButton = document.getElementById("modal-connect");
      document.getElementById("modal-connect").click();
    }
      
  </script>